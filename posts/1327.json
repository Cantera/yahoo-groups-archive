{"ygPerms":{"resourceCapabilityList":[{"resourceType":"GROUP","capabilities":[{"name":"READ"},{"name":"JOIN"}]},{"resourceType":"PHOTO","capabilities":[]},{"resourceType":"FILE","capabilities":[]},{"resourceType":"MEMBER","capabilities":[]},{"resourceType":"LINK","capabilities":[]},{"resourceType":"CALENDAR","capabilities":[]},{"resourceType":"DATABASE","capabilities":[]},{"resourceType":"POLL","capabilities":[]},{"resourceType":"MESSAGE","capabilities":[{"name":"READ"}]},{"resourceType":"PENDING_MESSAGE","capabilities":[]},{"resourceType":"ATTACHMENTS","capabilities":[{"name":"READ"}]},{"resourceType":"PHOTOMATIC_ALBUMS","capabilities":[]},{"resourceType":"MEMBERSHIP_TYPE","capabilities":[]},{"resourceType":"POST","capabilities":[{"name":"READ"}]},{"resourceType":"PIN","capabilities":[]}],"groupUrl":"groups.yahoo.com","intlCode":"us"},"comscore":"pageview_candidate","ygData":{"userId":186652637,"authorName":"Michael Johnson","from":"Michael Johnson &lt;johns3c@...&gt;","profile":"vitalianimal","replyTo":"LIST","senderId":"pPOq-_8sYfE3ZXdSGAR92bCgAkZ19J4fdMzdhL2WRgKjL7kO9-a8_QAUUGjXdbeEXU-0BSsDdn_Z5Fj6P_U1DdB-uDkTDXrixhDfiw","spamInfo":{"isSpam":false,"reason":"0"},"subject":"Re: [cantera] Re: Fortran - problem with meanmolarmass()","postDate":"1159907589","msgId":1327,"canDelete":false,"contentTrasformed":false,"systemMessage":false,"headers":{"messageIdInHeader":"PDQ1MjJDOTA1LjEwMTAwMDZAdXdpbmRzb3IuY2E+","inReplyToHeader":"PDNBQ0M3ODk3QTk0NjMxNDFCRTBEOTM4RkMzMURGRDE5MDIxQUNFQUZARVMyMlNOTE5ULnNybi5zYW5kaWEuZ292Pg==","referencesHeader":"PDNBQ0M3ODk3QTk0NjMxNDFCRTBEOTM4RkMzMURGRDE5MDIxQUNFQUZARVMyMlNOTE5ULnNybi5zYW5kaWEuZ292Pg=="},"prevInTopic":1326,"nextInTopic":1328,"prevInTime":1326,"nextInTime":1328,"topicId":1314,"numMessagesInTopic":7,"msgSnippet":"Hi Harry and Dan, I checked out and built Cantera from CVS today, but am still getting very strange results from a simple Fortran example problem: PROGRAM","rawEmail":"Return-Path: &lt;johns3c@...&gt;\r\nX-Sender: johns3c@...\r\nX-Apparently-To: cantera@yahoogroups.com\r\nReceived: (qmail 5425 invoked from network); 3 Oct 2006 20:33:33 -0000\r\nReceived: from unknown (66.218.66.166)\n  by m35.grp.scd.yahoo.com with QMQP; 3 Oct 2006 20:33:33 -0000\r\nReceived: from unknown (HELO pmails2.uwindsor.ca) (137.207.32.18)\n  by mta5.grp.scd.yahoo.com with SMTP; 3 Oct 2006 20:33:33 -0000\r\nReceived: from [127.0.0.1] (lb121b-12-pc.ends.uwindsor.ca [137.207.15.192])\n\tby pmails2.uwindsor.ca (8.13.8/8.13.8) with ESMTP id k93KX9EW024258\n\tfor &lt;cantera@yahoogroups.com&gt;; Tue, 3 Oct 2006 16:33:09 -0400 (EDT)\n\t(envelope-from johns3c@...)\r\nMessage-ID: &lt;4522C905.1010006@...&gt;\r\nDate: Tue, 03 Oct 2006 16:33:09 -0400\r\nUser-Agent: Thunderbird 1.5.0.2 (Windows/20060308)\r\nMIME-Version: 1.0\r\nTo: cantera@yahoogroups.com\r\nReferences: &lt;3ACC7897A9463141BE0D938FC31DFD19021ACEAF@...&gt;\r\nIn-Reply-To: &lt;3ACC7897A9463141BE0D938FC31DFD19021ACEAF@...&gt;\r\nContent-Type: text/plain; charset=ISO-8859-1; format=flowed\r\nContent-Transfer-Encoding: 8bit\r\nX-PerlMx-Spam: Gauge=IIIIIII, Probability=7%, Report=&#39;__C230066_P5 0, __CP_URI_IN_BODY 0, __CT 0, __CTE 0, __CT_TEXT_PLAIN 0, __HAS_MSGID 0, __MIME_TEXT_ONLY 0, __MIME_VERSION 0, __SANE_MSGID 0, __USER_AGENT 0&#39;\r\nX-eGroups-Msg-Info: 1:0:0:0\r\nFrom: Michael Johnson &lt;johns3c@...&gt;\r\nSubject: Re: [cantera] Re: Fortran - problem with meanmolarmass()\r\nX-Yahoo-Group-Post: member; u=186652637; y=RIHl_9PNGUrq56kgFutazpTDgWK-2UTKvoF9ntjnP98XymbK5ew_\r\nX-Yahoo-Profile: vitalianimal\r\n\r\nHi Harry and Dan,\n\nI checked out and built Cantera from CVS today, but am still getting \nvery strange results from a simple Fortran example problem:\n\n       PROGRAM CANTERATEST\n       IMPLICIT DOUBLE PRECISION (A-H,O-Z)\n       dimension Y(53)\n\n       DO 10 I=1,53\n             Y(I) = 0.0\n  10   CONTINUE\n\n       p = 101325.0\n       t = 300.0\n       Y(4) = 0.233\n       Y(48) = 0.767\n\n       call newIdealGasMix(&#39;gri30.cti&#39;,&#39;gri30_mix&#39;,&#39;Mix&#39;)\n       call setState_TPY(t,p,Y)\n\n       WRITE(*,30) meanMolarMass()\n       WRITE(*,30) intEnergy_mass()\n\n  30   format(E16.8)\n       STOP\n       END\n\nThis program returns the following values:\n    .00000000E+00\n    .45969286E-33\n\nI compiled demo_ftnlib.cpp and my example program file the same way they \nare done for the demo.f program included in the distribution \n(/usr/local/cantera/templates/f77/), which on my system looks like this:\n\ng++ -c demo_ftnlib.cpp -I/usr/local/cantera/include -O3 -Wall\ng77 -c canteratest.f -O3  -fno-second-underscore\ng++ -o test canteratest.o demo_ftnlib.o -L/usr/local/cantera/lib \n-L/usr/local/lib    -luser -loneD -lzeroD -ltransport -lcantera \n-lsundials_cvodes -lsundials_nvecserial -lctlapack -lctblas -lctmath \n-ltpx -lctf2c -lconverters -lctcxx  -L/usr/local/lib \n-L/usr/lib/gcc-lib/i586-suse-linux/3.3.4 \n-L/usr/lib/gcc-lib/i586-suse-linux/3.3.4/../../../../i586-suse-linux/lib \n-L/usr/lib/gcc-lib/i586-suse-linux/3.3.4/../../.. -lfrtbegin -lg2c -lm \n-lgcc_s\n\n\nWhy would meanMolarMass() and intEnergy_mass() be returning such bogus \nnumbers?\nThanks,\nMichael\n\n\n\nMoffat, Harry K wrote:\n&gt; \n&gt; \n&gt; Hi Dan,\n&gt; \n&gt; I have fixed one aspect of this problem within the CVS code. Previously,\n&gt; after initialization, if the mole or mass fractions were not set in the\n&gt; CTI or CTML file within the state XML block, the ThermoPhase object\n&gt; would have its mass fraction vector come back from initialization with\n&gt; it all set to zeroes. Therefore, the mean molecular weight would return\n&gt; a zero value, until the setstate_TPX() or setstate_TPY() routines were\n&gt; called.\n&gt; \n&gt; I just committed a change to the CVS repository so that species #0 will\n&gt; have its mass fraction set to 1.0 at initialization but before Cantera\n&gt; handles the state XML block information. Therefore, the mass fraction\n&gt; vector should sum to one from the get-go.\n&gt; \n&gt; I hope the problems you are seeing will be fixed by this. However, I\n&gt; would be very interested to know if this is not the case.\n&gt; meanMolarMass() is just a wrapper around the kernel routine,\n&gt; State::meanMolecularWeight(), in the State object. Cantera&#39;s independent\n&gt; variables are density, temperature, and the mass fraction vector. The\n&gt; mean molecular weight is calculated whenever the mass fraction vector is\n&gt; changed. Then, the meanMolecularWeight() function just reports the\n&gt; number. Setting the temperature or the density (or equivalently the\n&gt; pressure) shouldn&#39;t affect the internally calculated meanMolecularWeight\n&gt; value.\n&gt; \n&gt; Best wishes,\n&gt; Harry\n&gt; \n&gt; Harry Moffat (w) (505)\n&gt; 844-6912\n&gt; Multiphase Transport Processes Division (f) (505) 844-9297\n&gt; Sandia National Laboratories\n&gt; hkmoffa@... &lt;mailto:hkmoffa%40sandia.gov&gt;\n&gt; P. O. Box 5800-0834\n&gt; Albuquerque, NM 87185-0834\n&gt; \n&gt; -----Original Message-----\n&gt; From: cantera@yahoogroups.com &lt;mailto:cantera%40yahoogroups.com&gt; \n&gt; [mailto:cantera@yahoogroups.com &lt;mailto:cantera%40yahoogroups.com&gt;] On \n&gt; Behalf\n&gt; Of Dan Smyth\n&gt; Sent: Friday, September 29, 2006 4:08 PM\n&gt; To: cantera@yahoogroups.com &lt;mailto:cantera%40yahoogroups.com&gt;\n&gt; Subject: [cantera] Re: Fortran - problem with meanmolarmass()\n&gt; \n&gt; Hey Michael,\n&gt; \n&gt; An associate and I are trying to replace Chemkin calls, within a\n&gt; developed Fortran code, with Cantera calls through the demo_lib.cpp\n&gt; interface as a guide. We have been having some trouble with the\n&gt; meanmolarmass() call. Sometimes it will work and other times it will\n&gt; not. (When it will not work, the code will return a segmentation fault\n&gt; within our Fortran code when the value returned is printed out).\n&gt; We are guessing at this point that there is some conflict that we have\n&gt; not found yet that makes this call work intermittently. It does work at\n&gt; points in our code though, and so we think that this is a coding issue\n&gt; on our side and not a Cantera issue.\n&gt; \n&gt; Dan Smyth\n&gt; \n&gt; --- In cantera@yahoogroups.com &lt;mailto:cantera%40yahoogroups.com&gt;, \n&gt; Michael Johnson &lt;johns3c@...&gt; wrote:\n&gt;  &gt;\n&gt;  &gt; Dear Cantera group,\n&gt;  &gt;\n&gt;  &gt; I am working on channel-flow simulations with DASSL, coupled to\n&gt; Cantera.\n&gt;  &gt; The command meanmolarmass() returns a value of 0.0000E+00 but if I\n&gt;  &gt; take the ratio of, say, cp_mole()/cp_mass() it does return the proper\n&gt; value.\n&gt;  &gt;\n&gt;  &gt; I&#39;m running on Linux, using the demo_ftnlib.cpp provided with the\n&gt; source\n&gt;  &gt; code. I have looked through the header files under\n&gt;  &gt; /usr/local/include/cantera but have been unable to find where\n&gt;  &gt; meanMolecularWeight() is defined. It is certainly used to calculate\n&gt;  &gt; molar properties with no problem, but I can&#39;t figure out why\n&gt;  &gt; meanmolarmass() is not giving the proper value.\n&gt;  &gt;\n&gt;  &gt; Is anyone out there using Cantera in Fortran?\n&gt;  &gt; Thanks,\n&gt;  &gt; Michael\n&gt;  &gt;\n&gt; \n&gt; Yahoo! Groups Links\n&gt; \n&gt; \n\n"}}